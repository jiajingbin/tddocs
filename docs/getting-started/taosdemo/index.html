<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<link rel="alternate" type="application/rss+xml" href="/tddocs/blog/rss.xml" title="TDengine 文档（预览） RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/tddocs/blog/atom.xml" title="TDengine 文档（预览） Atom Feed"><title data-react-helmet="true">如何使用 taosBenchmark 进行性能测试 | TDengine 文档（预览）</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://dingbo8128.github.io/tddocs/docs/getting-started/taosdemo"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="如何使用 taosBenchmark 进行性能测试 | TDengine 文档（预览）"><meta data-react-helmet="true" name="description" content="自从 TDengine 2019 年 7 月开源以来，凭借创新的数据建模设计、快捷的安装方式、易用的编程接口和强大的数据写入查询性能博得了大量时序数据开发者的青睐。其中写入和查询性能往往令刚接触 TDengine 的用户称叹不已。为了便于用户在最短时间内就可以体验到 TDengine 的高性能特点，我们专门开发了一个应用程序 taosBenchmark （曾命名为 taosdemo）用于对 TDengine 进行写入和查询的性能测试，用户可以通过 taosBenchmark 轻松模拟大量设备产生海量数据的场景，并且可以通过 taosBenchmark 参数灵活控制表的列数、数据类型、乱序比例以及并发线程数量。"><meta data-react-helmet="true" property="og:description" content="自从 TDengine 2019 年 7 月开源以来，凭借创新的数据建模设计、快捷的安装方式、易用的编程接口和强大的数据写入查询性能博得了大量时序数据开发者的青睐。其中写入和查询性能往往令刚接触 TDengine 的用户称叹不已。为了便于用户在最短时间内就可以体验到 TDengine 的高性能特点，我们专门开发了一个应用程序 taosBenchmark （曾命名为 taosdemo）用于对 TDengine 进行写入和查询的性能测试，用户可以通过 taosBenchmark 轻松模拟大量设备产生海量数据的场景，并且可以通过 taosBenchmark 参数灵活控制表的列数、数据类型、乱序比例以及并发线程数量。"><link data-react-helmet="true" rel="icon" href="/tddocs/img/tdengine.ico"><link data-react-helmet="true" rel="canonical" href="https://dingbo8128.github.io/tddocs/docs/getting-started/taosdemo"><link data-react-helmet="true" rel="alternate" href="https://dingbo8128.github.io/tddocs/docs/getting-started/taosdemo" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://dingbo8128.github.io/tddocs/docs/getting-started/taosdemo" hreflang="x-default"><link rel="stylesheet" href="/tddocs/assets/css/styles.0c9264a6.css">
<link rel="preload" href="/tddocs/assets/js/runtime~main.3310c905.js" as="script">
<link rel="preload" href="/tddocs/assets/js/main.34e22e9a.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/tddocs/"><div class="navbar__logo"><img src="/tddocs/img/logo.jpg" alt="TDengine" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/tddocs/img/logo.jpg" alt="TDengine" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">TDengine</b></a><a class="navbar__item navbar__link navbar__link--active" href="/tddocs/docs/intro">文档</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/taosdata/TDengine" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_Pssr toggle_TdHA toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">🌜</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">🌞</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/tddocs/docs/intro">TDengine 介绍</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_VCh3" aria-current="page" href="/tddocs/docs/getting-started/get-started">快速入门</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/tddocs/docs/getting-started/get-started">get-started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/tddocs/docs/getting-started/docker">通过 Docker 快速体验</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/tddocs/docs/getting-started/taosdemo">性能测试</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/tddocs/docs/getting-started/install">安装和卸载</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/tddocs/docs/architecture/arch">整体架构</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/tddocs/docs/model">数据建模</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/tddocs/docs/taos-sql/tsql">SQL手册</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/tddocs/docs/insert">高效写入</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/tddocs/docs/query">高效查询</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/tddocs/docs/advance-feature">高级功能</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" href="/tddocs/docs/connector/">连接器</a><button aria-label="Toggle the collapsible sidebar category &#x27;连接器&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/tddocs/docs/connections">与其他工具的连接</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/tddocs/docs/cluster">TDengine 集群安装、管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/tddocs/docs/operation">TDengine 的运营与维护</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_cwdi"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_xORG"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>如何使用 taosBenchmark 进行性能测试</h1><p>自从 TDengine 2019 年 7 月开源以来，凭借创新的数据建模设计、快捷的安装方式、易用的编程接口和强大的数据写入查询性能博得了大量时序数据开发者的青睐。其中写入和查询性能往往令刚接触 TDengine 的用户称叹不已。为了便于用户在最短时间内就可以体验到 TDengine 的高性能特点，我们专门开发了一个应用程序 taosBenchmark （曾命名为 taosdemo）用于对 TDengine 进行写入和查询的性能测试，用户可以通过 taosBenchmark 轻松模拟大量设备产生海量数据的场景，并且可以通过 taosBenchmark 参数灵活控制表的列数、数据类型、乱序比例以及并发线程数量。</p><p>运行 taosBenchmark 很简单，通过下载 <a href="https://www.taosdata.com/cn/all-downloads/" target="_blank" rel="noopener noreferrer">TDengine 安装包</a>或者自行下载 <a href="https://github.com/taosdata/TDengine" target="_blank" rel="noopener noreferrer">TDengine 代码</a>编译都可以在安装目录或者编译结果目录中找到并运行。</p><p>接下来本文为大家讲解 taosBenchmark 的使用介绍及注意事项。</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="使用-taosbenchmark-进行写入测试">使用 taosBenchmark 进行写入测试<a class="hash-link" href="#使用-taosbenchmark-进行写入测试" title="Direct link to heading">​</a></h2><p>不使用任何参数的情况下执行 taosBenchmark 命令，输出如下：</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ taosBenchmark</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">taosBenchmark is simulating data generated by power equipment monitoring...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">host:                       127.0.0.1:6030</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">user:                       root</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password:                   taosdata</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">configDir:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">resultFile:                 ./output.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">thread num of insert data:  8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">thread num of create table: 8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">top insert interval:        0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">number of records per req:  30000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">max sql length:             1048576</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">database count:             1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">database[0]:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  database[0] name:      test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  drop:                  yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  replica:               1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  precision:             ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  super table count:     1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  super table[0]:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      stbName:           meters</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      autoCreateTable:   no</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      childTblExists:    no</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      childTblCount:     10000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      childTblPrefix:    d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      dataSource:        rand</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      iface:             taosc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      insertRows:        10000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      interlaceRows:     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      disorderRange:     1000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      disorderRatio:     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      maxSqlLen:         1048576</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      timeStampStep:     1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      startTimestamp:    2017-07-14 10:40:00.000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      sampleFormat:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      sampleFile:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      tagsFile:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      columnCount:       3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">column[0]:FLOAT column[1]:INT column[2]:FLOAT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      tagCount:            2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        tag[0]:INT tag[1]:BINARY(16)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         Press enter key to continue or Ctrl-C to stop</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>这里显示的是接下来 taosBenchmark 进行数据写入的各项参数。默认不输入任何命令行参数的情况下 taosBenchmark 将模拟生成一个电力行业典型应用的电表数据采集场景数据。即建立一个名为 test 的数据库，并创建一个名为 meters 的超级表，其中表结构为：</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">taos&gt; describe test.meters;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             Field              |         Type         |   Length    |   Note   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=================================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ts                             | TIMESTAMP            |           8 |          |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> current                        | FLOAT                |           4 |          |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> voltage                        | INT                  |           4 |          |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> phase                          | FLOAT                |           4 |          |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> groupid                        | INT                  |           4 | TAG      |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> location                       | BINARY               |          64 | TAG      |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Query OK, 6 row(s) in set (0.002972s)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>按任意键后 taosBenchmark 将建立数据库 test 和超级表 meters，并按照 TDengine 数据建模的最佳实践，以 meters 超级表为模板生成一万个子表，代表一万个独立上报数据的电表设备。</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">taos&gt; use test;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Database changed.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">taos&gt; show stables;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              name              |      created_time       | columns |  tags  |   tables    |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">============================================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> meters                         | 2021-08-27 11:21:01.209 |       4 |      2 |       10000 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Query OK, 1 row(s) in set (0.001740s)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>然后 taosBenchmark 为每个电表设备模拟生成一万条记录：</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">====thread[3] completed total inserted rows: 6250000, total affected rows: 6250000. 347626.22 records/second====</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[1]:100%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">====thread[1] completed total inserted rows: 6250000, total affected rows: 6250000. 347481.98 records/second====</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[4]:100%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">====thread[4] completed total inserted rows: 6250000, total affected rows: 6250000. 347149.44 records/second====</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[8]:100%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">====thread[8] completed total inserted rows: 6250000, total affected rows: 6250000. 347082.43 records/second====</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[6]:99%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[6]:100%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">====thread[6] completed total inserted rows: 6250000, total affected rows: 6250000. 345586.35 records/second====</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Spent 18.0863 seconds to insert rows: 100000000, affected rows: 100000000 with 16 thread(s) into test.meters. 5529049.90 records/second</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert delay, avg:      28.64ms, max:     112.92ms, min:       9.35ms</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>以上信息是在一台具备 8 个 CPU 64G 内存的普通 PC 服务器上进行实测的结果。显示 taosBenchmark 用了 18 秒的时间插入了 100000000 （一亿）条记录，平均每秒钟插入 552 万 9 千零 49 条记录。</p><p>TDengine 还提供性能更好的参数绑定接口，而在同样的硬件上使用参数绑定接口 （taosBenchmark -I stmt ）进行相同数据量的写入，结果如下：</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">====thread[14] completed total inserted rows: 6250000, total affected rows: 6250000. 1097331.55 records/second====</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[9]:97%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[4]:97%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[3]:97%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[3]:98%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[4]:98%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[9]:98%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[3]:99%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[4]:99%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[3]:100%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">====thread[3] completed total inserted rows: 6250000, total affected rows: 6250000. 1089038.19 records/second====</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[9]:99%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[4]:100%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">====thread[4] completed total inserted rows: 6250000, total affected rows: 6250000. 1087123.09 records/second====</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[9]:100%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">====thread[9] completed total inserted rows: 6250000, total affected rows: 6250000. 1085689.38 records/second====</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[11]:91%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[11]:92%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[11]:93%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[11]:94%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[11]:95%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[11]:96%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[11]:97%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[11]:98%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[11]:99%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[11]:100%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">====thread[11] completed total inserted rows: 6250000, total affected rows: 6250000. 1039087.65 records/second====</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Spent 6.0257 seconds to insert rows: 100000000, affected rows: 100000000 with 16 thread(s) into test.meters. 16595590.52 records/second</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert delay, avg:       8.31ms, max:     860.12ms, min:       2.00ms</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>显示 taosBenchmark 用了 6 秒的时间插入了一亿条记录，每秒钟插入性能高达 1659 万 5 千 590 条记录。</p><p>由于 taosBenchmark 使用起来非常方便，我们又对 taosBenchmark 做了更多的功能扩充，使其支持更复杂的参数设置，便于进行快速原型开发的样例数据准备和验证工作。</p><p>完整的 taosBenchmark 命令行参数列表可以通过 taosBenchmark --help 显示如下：</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ taosBenchmark --help</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-f, --file=FILE The meta file to the execution procedure. Currently, we support standard UTF-8 (without BOM) encoded files only.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-u, --user=USER The user name to use when connecting to the server.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-p, --password The password to use when connecting to the server.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-c, --config-dir=CONFIG_DIR Configuration directory.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-h, --host=HOST TDengine server FQDN to connect. The default host is localhost.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-P, --port=PORT The TCP/IP port number to use for the connection.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-I, --interface=INTERFACE The interface (taosc, rest, and stmt) taosBenchmark uses. By default use &#x27;taosc&#x27;.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-d, --database=DATABASE Destination database. By default is &#x27;test&#x27;.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-a, --replica=REPLICA Set the replica parameters of the database, By default use 1, min: 1, max: 3.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-m, --table-prefix=TABLEPREFIX Table prefix name. By default use &#x27;d&#x27;.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-s, --sql-file=FILE The select sql file.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-N, --normal-table Use normal table flag.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-o, --output=FILE Direct output to the named file. By default use &#x27;./output.txt&#x27;.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-q, --query-mode=MODE Query mode -- 0: SYNC, 1: ASYNC. By default use SYNC.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-b, --data-type=DATATYPE The data_type of columns, By default use: FLOAT, INT, FLOAT.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-w, --binwidth=WIDTH The width of data_type &#x27;BINARY&#x27; or &#x27;NCHAR&#x27;. By default use 64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-l, --columns=COLUMNS The number of columns per record. Demo mode by default is 1 (float, int, float). Max values is 4095</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">All of the new column(s) type is INT. If use -b to specify column type, -l will be ignored.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-T, --threads=NUMBER The number of threads. By default use 8.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-i, --insert-interval=NUMBER The sleep time (ms) between insertion. By default is 0.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-S, --time-step=TIME_STEP The timestamp step between insertion. By default is 1.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-B, --interlace-rows=NUMBER The interlace rows of insertion. By default is 0.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-r, --rec-per-req=NUMBER The number of records per request. By default is 30000.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-t, --tables=NUMBER The number of tables. By default is 10000.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-n, --records=NUMBER The number of records per table. By default is 10000.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-M, --random The value of records generated are totally random.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">By default to simulate power equipment scenario.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-x, --aggr-func Test aggregation functions after insertion.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-y, --answer-yes Input yes for prompt.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-O, --disorder=NUMBER Insert order mode--0: In order, 1 ~ 50: disorder ratio. By default is in order.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-R, --disorder-range=NUMBER Out of order data&#x27;s range. Unit is ms. By default is 1000.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-g, --debug Print debug info.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-?, --help Give this help list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--usage Give a short usage message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-V, --version Print program version.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Mandatory or optional arguments to long options are also mandatory or optional</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for any corresponding short options.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Report bugs to &lt;support@taosdata.com&gt;.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>taosBenchmark 的参数是为了满足数据模拟的需求来设计的。下面介绍几个常用的参数：</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">-I, --interface=INTERFACE     The interface (taosc, rest, and stmt) taosBenchmark uses. Default is &#x27;taosc&#x27;.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>前面介绍 taosBenchmark 不同接口的性能差异已经提到， -I 参数为选择不同的接口，目前支持 taosc、stmt 和 rest 几种。其中 taosc 为使用 SQL 语句方式进行数据写入；stmt 为使用参数绑定接口进行数据写入；rest 为使用 RESTful 协议进行数据写入。</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">-T, --threads=NUMBER          The number of threads. Default is 8.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>-T 参数设置 taosBenchmark 使用多少个线程进行数据同步写入，通过多线程可以尽最大可能压榨硬件的处理能力。</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">-b, --data-type=DATATYPE      The data_type of columns, default: FLOAT, INT, FLOAT.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-w, --binwidth=WIDTH          The width of data_type &#x27;BINARY&#x27; or &#x27;NCHAR&#x27;. Default is 64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-l, --columns=COLUMNS         The number of columns per record. Demo mode by default is 3 (float, int, float). Max values is 4095</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>前文提到，taosBenchmark 默认创建一个典型电表数据采集应用场景，每个设备包含电流电压相位 3 个采集量。对于需要定义不同的采集量，可以使用 -b 参数。TDengine 支持 BOOL、TINYINT、SMALLINT、INT、BIGINT、FLOAT、DOUBLE、BINARY、NCHAR、TIMESTAMP 等多种数据类型。通过 -b 加上以“ , ”（英文逗号）分割定制类型的列表可以使 taosBenchmark 建立对应的超级表和子表并插入相应模拟数据。通过 -w 参数可以指定 BINARY 和 NCHAR 数据类型的列的宽度（默认为 64 ）。-l 参数可以在 -b 参数指定数据类型的几列之后补充以 INT 型的总的列数，特别多列的情况下可以减少手工输入的过程，最多支持到 4095 列。</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">-r, --rec-per-req=NUMBER      The number of records per request. Default is 30000.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>为了达到 TDengine 性能极限，可以使用多客户端、多线程以及一次插入多条数据来进行数据写入。 -r 参数为设置一次写入请求可以拼接的记录条数，默认为 30000 条。有效的拼接记录条数还和客户端缓冲区大小有关，目前的缓冲区为 1M Bytes，如果记录的列宽度比较大，最大拼接记录条数可以通过 1M 除以列宽（以字节为单位）计算得出。</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">-t, --tables=NUMBER           The number of tables. Default is 10000.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-n, --records=NUMBER          The number of records per table. Default is 10000.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-M, --random                  The value of records generated are totally random. The default is to simulate power equipment senario.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>前面提到 taosBenchmark 默认创建 10000 个表，每个表写入 10000 条记录。可以通过 -t 和 -n 设置表的数量和每个表的记录的数量。默认无参数生成的数据为模拟真实场景，模拟生成的数据为电流电压相位值增加一定的抖动，可以更真实表现 TDengine 高效的数据压缩能力。如果需要模拟生成完全随机数据，可以通过 -M 参数。</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">-y, --answer-yes              Default input yes for prompt.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>前面我们可以看到 taosBenchmark 默认在进行创建数据库或插入数据之前输出将要进行操作的参数列表，方便使用者在插入之前了解即将进行的数据写入的内容。为了方便进行自动测试，-y 参数可以使 taosBenchmark 输出参数后立刻进行数据写入操作。</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">-O, --disorder=NUMBER         Insert order mode--0: In order, 1 ~ 50: disorder ratio. Default is in order.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-R, --disorder-range=NUMBER   Out of order data&#x27;s range, ms, default is 1000.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>在某些场景，接收到的数据并不是完全按时间顺序到来，而是包含一定比例的乱序数据，TDengine 也能进行很好的处理。为了模拟乱序数据的写入，taosBenchmark 提供 -O 和 -R 参数进行设置。-O 参数为 0 和不使用 -O 参数相同为完全有序数据写入。1 到 50 为数据中包含乱序数据的比例。-R 参数为乱序数据时间戳偏移的范围，默认为 1000 毫秒。另外注意，时序数据以时间戳为唯一标识，所以乱序数据可能会生成和之前已经写入数据完全相同的时间戳，这样的数据会根据数据库创建的 update 值或者被丢弃（update 0）或者覆盖已有数据（update 1 或 2），而总的数据条数可能和期待的条数不一致的情况。</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain"> -g, --debug                   Print debug info.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>如果对 taosBenchmark 写入数据过程感兴趣或者数据写入结果不符合预期，可以使用 -g 参数使 taosBenchmark 打印执行过程中间调试信息到屏幕上，或通过 Linux 重定向命令导入到另外一个文件，方便找到发生问题的原因。另外 taosBenchmark 在执行失败后也会把相应执行的语句和调试原因输出到屏幕。可以搜索 reason 来找到 TDengine 服务端返回的错误原因信息。</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">-x, --aggr-func               Test aggregation funtions after insertion.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>TDengine 不仅仅是插入性能非常强大，由于其先进的数据库引擎设计使查询性能也异常强大。taosBenchmark 提供一个 -x 函数，可以在插入数据结束后进行常用查询操作并输出查询消耗时间。以下为在前述服务器上进行插入一亿条记录后进行常用查询的结果。</p><p>可以看到 select <!-- -->*<!-- --> 取出一亿条记录（不输出到屏幕）操作仅消耗 1.26 秒。而对一亿条记录进行常用的聚合函数操作通常仅需要二十几毫秒，时间最长的 count 函数也不到四十毫秒。</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">taosBenchmark -I stmt -T 48 -y -x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select          * took 1.266835 second(s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select   count(*) took 0.039684 second(s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Where condition: groupid = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select avg(current) took 0.025897 second(s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select sum(current) took 0.025622 second(s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select max(current) took 0.026124 second(s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select min(current) took 0.025812 second(s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select first(current) took 0.024105 second(s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>除了命令行方式， taosBenchmark 还支持接受指定一个 JSON 文件做为传入参数的方式来提供更丰富的设置。一个典型的 JSON 文件内容如下：</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;filetype&quot;: &quot;insert&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;cfgdir&quot;: &quot;/etc/taos&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;host&quot;: &quot;127.0.0.1&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;port&quot;: 6030,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;user&quot;: &quot;root&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;password&quot;: &quot;taosdata&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;thread_count&quot;: 4,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;thread_count_create_tbl&quot;: 4,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;result_file&quot;: &quot;./insert_res.txt&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;confirm_parameter_prompt&quot;: &quot;no&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;insert_interval&quot;: 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;interlace_rows&quot;: 100,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;num_of_records_per_req&quot;: 100,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;databases&quot;: [{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;dbinfo&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;name&quot;: &quot;db&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;drop&quot;: &quot;yes&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;replica&quot;: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;days&quot;: 10,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;cache&quot;: 16,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;blocks&quot;: 8,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;precision&quot;: &quot;ms&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;keep&quot;: 3650,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;minRows&quot;: 100,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;maxRows&quot;: 4096,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;comp&quot;:2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;walLevel&quot;:1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;cachelast&quot;:0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;quorum&quot;:1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;fsync&quot;:3000,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;update&quot;: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;super_tables&quot;: [{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;name&quot;: &quot;stb&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;child_table_exists&quot;:&quot;no&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;childtable_count&quot;: 100,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;childtable_prefix&quot;: &quot;stb_&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;auto_create_table&quot;: &quot;no&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;batch_create_tbl_num&quot;: 5,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;data_source&quot;: &quot;rand&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;insert_mode&quot;: &quot;taosc&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;insert_rows&quot;: 100000,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;childtable_limit&quot;: 10,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;childtable_offset&quot;:100,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;interlace_rows&quot;: 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;insert_interval&quot;:0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;max_sql_len&quot;: 1024000,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;disorder_ratio&quot;: 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;disorder_range&quot;: 1000,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;timestamp_step&quot;: 10,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;start_timestamp&quot;: &quot;2020-10-01 00:00:00.000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;sample_format&quot;: &quot;csv&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;sample_file&quot;: &quot;./sample.csv&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;tags_file&quot;: &quot;&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;columns&quot;: [{&quot;type&quot;: &quot;INT&quot;}, {&quot;type&quot;: &quot;DOUBLE&quot;, &quot;count&quot;:10}, {&quot;type&quot;: &quot;BINARY&quot;, &quot;len&quot;: 16, &quot;count&quot;:3}, {&quot;type&quot;: &quot;BINARY&quot;, &quot;len&quot;: 32, &quot;count&quot;:6}],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;tags&quot;: [{&quot;type&quot;: &quot;TINYINT&quot;, &quot;count&quot;:2}, {&quot;type&quot;: &quot;BINARY&quot;, &quot;len&quot;: 16, &quot;count&quot;:5}]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>例如：我们可以通过 &quot;thread_count&quot; 和 &quot;thread_count_create_tbl&quot; 来为建表和插入数据指定不同数量的线程。可以通过 &quot;child_table_exists&quot;、&quot;childtable_limit&quot; 和 &quot;childtable_offset&quot; 的组合来使用多个 taosBenchmark 进程（甚至可以在不同的电脑上）对同一个超级表的不同范围子表进行同时写入。也可以通过 &quot;data_source&quot; 和 &quot;sample_file&quot; 来指定数据来源为 csv 文件，来实现导入已有数据的功能。</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="使用-taosbenchmark-进行查询和订阅测试">使用 taosBenchmark 进行查询和订阅测试<a class="hash-link" href="#使用-taosbenchmark-进行查询和订阅测试" title="Direct link to heading">​</a></h2><p>taosBenchmark 不仅仅可以进行数据写入，也可以执行查询和订阅功能。但一个 taosBenchmark 实例只能支持其中的一种功能，不能同时支持三种功能，通过配置文件来指定进行哪种功能的测试。</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="一个典型查询-json-示例文件内容">一个典型查询 JSON 示例文件内容<a class="hash-link" href="#一个典型查询-json-示例文件内容" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;filetype&quot;: &quot;query&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;cfgdir&quot;: &quot;/etc/taos&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;host&quot;: &quot;127.0.0.1&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;port&quot;: 6030,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;user&quot;: &quot;root&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;password&quot;: &quot;taosdata&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;confirm_parameter_prompt&quot;: &quot;no&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;databases&quot;: &quot;db&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;query_times&quot;: 2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;query_mode&quot;: &quot;taosc&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;specified_table_query&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;query_interval&quot;: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;concurrent&quot;: 3,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;sqls&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;sql&quot;: &quot;select last_row(*) from stb0 &quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;result&quot;: &quot;./query_res0.txt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;sql&quot;: &quot;select count(*) from stb00_1&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;result&quot;: &quot;./query_res1.txt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;super_table_query&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;stblname&quot;: &quot;stb1&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;query_interval&quot;: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;threads&quot;: 3,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;sqls&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;sql&quot;: &quot;select last_row(ts) from xxxx&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;result&quot;: &quot;./query_res2.txt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="查询相关的特有参数含义">查询相关的特有参数含义<a class="hash-link" href="#查询相关的特有参数含义" title="Direct link to heading">​</a></h3><p>&quot;query_times&quot;: 每种查询类型的查询次数</p><p>&quot;query_mode&quot;: 查询数据接口，&quot;taosc&quot;：调用 TDengine 的 c 接口；“resetful”：使用 restfule 接口。可选项。缺省是“taosc”。</p><p>&quot;specified_table_query&quot;: { 指定表的查询</p><p>&quot;query_interval&quot;: 执行 sqls 的间隔，单位是秒。可选项，缺省是 0。</p><p>&quot;concurrent&quot;: 并发执行 sqls 的线程数，可选项，缺省是 1。每个线程都执行所有的 sqls。</p><p>&quot;sqls&quot;: 可以添加多个 sql 语句，最多支持 100 条。</p><p>&quot;sql&quot;: 查询语句。必选项。</p><p>&quot;result&quot;: 查询结果写入的文件名。可选项，缺省是空，表示查询结果不写入文件。</p><p>&quot;super_table_query&quot;: { 对超级表中所有子表的查询</p><p>&quot;stblname&quot;: 超级表名称。必选项。</p><p>&quot;query_interval&quot;: 执行 sqls 的间隔，单位是秒。可选项，缺省是 0。</p><p>&quot;threads&quot;: 并发执行 sqls 的线程数，可选项，缺省是 1。每个线程负责一部分子表，执行所有的 sqls。</p><p>&quot;sql&quot;: &quot;select count(<!-- -->*<!-- -->) from xxxx&quot;。查询超级表内所有子表的查询语句，其中表名必须写成 “xxxx”，实例会自动替换成子表名。</p><p>&quot;result&quot;: 查询结果写入的文件名。可选项，缺省是空，表示查询结果不写入文件。
`</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="典型订阅-json-示例文件内容">典型订阅 JSON 示例文件内容<a class="hash-link" href="#典型订阅-json-示例文件内容" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;filetype&quot;:&quot;subscribe&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;cfgdir&quot;: &quot;/etc/taos&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;host&quot;: &quot;127.0.0.1&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;port&quot;: 6030,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;user&quot;: &quot;root&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;password&quot;: &quot;taosdata&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;databases&quot;: &quot;db&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;confirm_parameter_prompt&quot;: &quot;no&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;specified_table_query&quot;:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &quot;concurrent&quot;:1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &quot;mode&quot;:&quot;sync&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &quot;interval&quot;:0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &quot;restart&quot;:&quot;yes&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &quot;keepProgress&quot;:&quot;yes&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &quot;sqls&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;sql&quot;: &quot;select * from stb00_0 ;&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;result&quot;: &quot;./subscribe_res0.txt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;super_table_query&quot;:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &quot;stblname&quot;: &quot;stb0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &quot;threads&quot;:1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &quot;mode&quot;:&quot;sync&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &quot;interval&quot;:10000,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &quot;restart&quot;:&quot;yes&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &quot;keepProgress&quot;:&quot;yes&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &quot;sqls&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;sql&quot;: &quot;select * from xxxx where ts &gt; &#x27;2021-02-25 11:35:00.000&#x27; ;&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;result&quot;: &quot;./subscribe_res1.txt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="订阅功能相关的特有参数含义">订阅功能相关的特有参数含义<a class="hash-link" href="#订阅功能相关的特有参数含义" title="Direct link to heading">​</a></h3><p>&quot;interval&quot;: 执行订阅的间隔，单位是秒。可选项，缺省是 0。</p><p>&quot;restart&quot;: 订阅重启。&quot;yes&quot;：如果订阅已经存在，重新开始，&quot;no&quot;: 继续之前的订阅。(请注意执行用户需要对 dataDir 目录有读写权限)</p><p>&quot;keepProgress&quot;: 保留订阅信息进度。yes 表示保留订阅信息，no 表示不保留。该值为 yes，restart 为 no 时，才能继续之前的订阅。</p><p>&quot;resubAfterConsume&quot;: 配合 keepProgress 使用，在订阅消费了相应次数后调用 unsubscribe 取消订阅并再次订阅。</p><p>&quot;result&quot;: 查询结果写入的文件名。可选项，缺省是空，表示查询结果不写入文件。 注意：每条 sql 语句后的保存结果的文件不能重名，且生成结果文件时，文件名会附加线程号。</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="结语">结语<a class="hash-link" href="#结语" title="Direct link to heading">​</a></h2><p>TDengine 是涛思数据专为物联网、车联网、工业互联网、IT 运维等设计和优化的大数据平台。TDengine 由于数据库内核中创新的数据存储和查询引擎设计，展现出远超同类产品的高效性能。并且由于支持 SQL 语法和多种编程语言的连接器（目前支持 Java, Python, Go, C#, NodeJS, Rust 等），易用性极强，学习成本为零。为了便于运维需求，我们还提供数据迁移和监控功能等相关生态工具软件。</p><p>为了刚接触 TDengine 的使用者方便进行技术评估和压力测试，我们为 taosBenchmark 开发了丰富的特性。本文即为对 taosBenchmark 的一个简单介绍，随着 TDengine 新功能的不断增加，taosBenchmark 也会继续演化和改进。taosBenchmark 的代码做为 TDengine 的一部分在 GitHub 上完全开源。欢迎就 taosBenchmark 或 TDengine 的使用或实现在 GitHub 或者涛思数据的用户群提出建议或批评。</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="附录">附录<a class="hash-link" href="#附录" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="完整-taosbenchmark-命令行参数介绍">完整 taosBenchmark 命令行参数介绍<a class="hash-link" href="#完整-taosbenchmark-命令行参数介绍" title="Direct link to heading">​</a></h3><p>taosBenchmark 支持两种配置参数的模式，一种是命令行参数，一种是使用 JSON 格式的配置文件。</p><table><thead><tr><th>选项</th><th>作用</th></tr></thead><tbody><tr><td>-f</td><td>指定 taosBenchmark 所需参数的 meta 文件。当使用该参数时，其他所有命令行参数都失效。可选项，缺省是 NULL。目前仅支持不含 BOM（byte-order mark）的标准 UTF-8 编码文件</td></tr><tr><td>-u</td><td>用户名。可选项，缺省是&quot;root&quot;</td></tr><tr><td>-p</td><td>密码。可选项，缺省是“taosdata&quot;。指定密码需要使用 MySQL 风格，即密码和 -p 贴紧方式，中间无空格</td></tr><tr><td>-c</td><td>配置文件 taos.cfg 所在的路径。因为 taosBenchmark 通过包含 taos 的动态库，去链接 taosd 服务，所以需要做好配置文件。可选项，缺省是 &quot;/etc/taos&quot;路径</td></tr><tr><td>-h</td><td>taosd 服务的 FQDN。可选项，缺省是&quot;localhost&quot;</td></tr><tr><td>-P</td><td>taosd 服务的端口号。可选项，缺省是 6030</td></tr><tr><td>-d</td><td>数据库名称。可选项，缺省是“test”</td></tr><tr><td>-a</td><td>副本个数，可选项。1 - 3，缺省是 1</td></tr><tr><td>-m</td><td>表名的前缀。可选项，缺省是“t”</td></tr><tr><td>-s</td><td>执行该文件包含的多条 SQL 查询命令</td></tr><tr><td>-N</td><td>使用普通建表模式。有该选项时，全部创建普通表，否则缺省创建超级表，再根据超级表创建子表</td></tr><tr><td>-o</td><td>指定执行结果输出文件的路径。可选项，缺省是./output.txt</td></tr><tr><td>-q</td><td>查询模式，0：同步模式；1：异步模式。可选项，缺省是 0</td></tr><tr><td>-b</td><td>列的类型。可选项，缺省是：FLOAT,INT,FLOAT。NCHAR 和 BINARY 也可以自定义长度，例如: NCHAR(16), BINARY(8)</td></tr><tr><td>-w</td><td>BINARY 或 NCHAR 数据类型的长度。可选项，缺省是 16</td></tr><tr><td>-l</td><td>列的个数。可选项，缺省是 3</td></tr><tr><td>-T</td><td>并发线程数。可选项，缺省是 10</td></tr><tr><td>-i</td><td>两次 sql 插入的休眠时间间隔，缺省是 0</td></tr><tr><td>-S</td><td>两次插入间隔时间戳步长，缺省是 1</td></tr><tr><td>-B</td><td>交错（interlace）写入模式，缺省是 0（顺序写入模式）</td></tr><tr><td>-r</td><td>每条插入请求包含的记录数，缺省是 30000</td></tr><tr><td>-t</td><td>表的个数。可选项，缺省是 10000</td></tr><tr><td>-n</td><td>每个表插入的记录数。可选项，缺省是 10000</td></tr></tbody></table><p>-M 插入数据为完全随机。可选项，缺省为模拟能源设备真实场景（数据在固定范围小幅波动）
-x | 不仅仅插入数据。有该选项时，taosBenchmark 还会进行聚合函数查询操作
-y | 提示询问输入时缺省输入 yes
-O | 插入乱序数据的比例，0：顺序插入；&gt; 0：乱序数据的百分比。可选项，缺省是 0
-R | 乱序百分比不为 0 时，乱序时间戳范围，单位：毫秒。可选项，缺省是 1000
-g | 打印 debug 信息
-V | 打印 taosBenchmark 的 debug 信息。
--help | 打印命令参数列表</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="json-格式的配置文件中所有参数说明">JSON 格式的配置文件中所有参数说明<a class="hash-link" href="#json-格式的配置文件中所有参数说明" title="Direct link to heading">​</a></h3><p>taosBenchmark 支持 3 种功能的测试，包括插入、查询、订阅。但一个 taosBenchmark 实例不能同时支持三种功能，一个 taosBenchmark 实例只能支持其中的一种功能，通过配置文件来指定进行哪种功能的测试。</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="插入功能测试的-json-配置文件">插入功能测试的 JSON 配置文件<a class="hash-link" href="#插入功能测试的-json-配置文件" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT language-json theme-code-block"><div class="codeBlockContent_wNvx json"><pre tabindex="0" class="prism-code language-json codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;filetype&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;insert&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;cfgdir&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/etc/taos&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;host&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;127.0.0.1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;port&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6030</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;user&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;root&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;password&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;taosdata&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;thread_count&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;thread_count_create_tbl&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;result_file&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;./insert_res.txt&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;confirm_parameter_prompt&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;no&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;insert_interval&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;interlace_rows&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;num_of_records_per_req&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;databases&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;dbinfo&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;db&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;drop&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;yes&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;replica&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;days&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;cache&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">16</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;blocks&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;precision&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ms&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;keep&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3650</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;minRows&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;maxRows&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4096</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;comp&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;walLevel&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;cachelast&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;quorum&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;fsync&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;update&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;super_tables&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;stb&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;child_table_exists&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;no&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;childtable_count&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;childtable_prefix&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;stb_&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;auto_create_table&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;no&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;batch_create_tbl_num&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;data_source&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;rand&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;insert_mode&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;taosc&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;insert_rows&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;childtable_limit&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;childtable_offset&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;interlace_rows&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;insert_interval&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;max_sql_len&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1024000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;disorder_ratio&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;disorder_range&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;timestamp_step&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;start_timestamp&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2020-10-01 00:00:00.000&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;sample_format&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;csv&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;sample_file&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;./sample.csv&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;use_sameple_ts&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;no&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;tags_file&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;columns&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;INT&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;DOUBLE&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;count&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;BINARY&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;len&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">16</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;count&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;BINARY&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;len&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;count&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;tags&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;TINYINT&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;count&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;BINARY&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;len&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">16</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;count&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="配置文件解释">配置文件解释<a class="hash-link" href="#配置文件解释" title="Direct link to heading">​</a></h4><p>&quot;filetype&quot;: 本 taosBenchmark 实例进行哪种功能测试。&quot;insert&quot;表示数据插入功能。必选项。</p><p>&quot;cfgdir&quot;: 配置文件 taos.cfg 所在的路径。因为 taosBenchmark 通过包含 taos 的动态库，去链接 taosd 服务，所以需要做好配置文件。可选项，缺省是 &quot;/etc/taos&quot;路径。</p><p>&quot;host&quot;: taosd 服务的 FQDN。可选项，缺省是“localhost“。</p><p>&quot;port&quot;: taosd 服务的端口号。可选项，缺省是 6030。</p><p>&quot;user&quot;: 用户名。可选项，缺省是“root“。</p><p>&quot;password&quot;: 密码。可选项，缺省是“taosdata&quot;。</p><p>&quot;thread_count&quot;: 插入数据时的并发线程数。可选项，缺省是 1。</p><p>&quot;thread_count_create_tbl&quot;: 建子表时的并发线程数。可选项，缺省是 1。</p><p>&quot;result_file&quot;: 测试完成后结果保存文件。可选项，缺省是本实例启动目录下的&quot;./insert_res.txt&quot;。</p><p>&quot;confirm_parameter_prompt&quot;: 执行过程中提示是否确认，为 no 时，执行过程无需手工输入 enter。可选项，缺省是 no。</p><p>&quot;insert_interval&quot;: 两次发送请求的间隔时间。可选项，缺省是 0，代表无人工设置的时间间隔，单位为 ms。。</p><p>&quot;interlace_rows&quot;: 设置轮询插入每个单表数据的条目数，如果 interlace_rows<em>childtable_count</em>supertable_num 小于 num_of_records_per_req 时，则请求插入的数目以 interlace_rows<em>childtable_count</em>supertable_num 为准。可选项，缺省是 0。</p><p>&quot;num_of_records_per_req&quot;: 每条请求数据内容包含的插入数据记录数目，该数据组成的 sql 不能大于 maxsqllen，如果过大，则取 taosd 限制的 1M 长度(1048576)。0 代表不插入数据，建议配置大于 0。</p><p>&quot;databases&quot;: [{</p><p>&quot;dbinfo&quot;: {&quot;name&quot;: 数据库名称。必选项。</p><p>&quot;drop&quot;: 如果数据库已经存在，”yes“：删除后重建；”no“：不删除，直接使用。可选项，缺省是”no“。drop = yes 会使其他子表创建相关条目无效。</p><p>&quot;replica&quot;: 副本个数，可选项。1 - 3，缺省是 1。</p><p>&quot;days&quot;: 数据文件存储数据的时间跨度，可选项。缺省是 10 天。</p><p>&quot;cache&quot;: 内存块的大小，单位是 MB，可选项。缺省是 16MB。</p><p>&quot;blocks&quot;: 每个 VNODE（TSDB）中有多少 cache 大小的内存块，可选项。缺省是 6 块。</p><p>&quot;precision&quot;: 数据库时间精度，可选项。&quot;ms&quot;：毫秒， “us”：微秒。缺省是“ms”。in</p><p>&quot;keep&quot;: 数据保留的天数，可选项。缺省是 3650 天。</p><p>&quot;minRows&quot;: 文件块中记录的最小条数，可选项。缺省是 100。</p><p>&quot;maxRows&quot;: 文件块中记录的最大条数，可选项。缺省是 4096.</p><p>&quot;comp&quot;:文件压缩标志位，可选项。0：关闭，1:一阶段压缩，2:两阶段压缩。缺省是 2。</p><p>&quot;walLevel&quot;:WAL 级别，可选项。1：写 wal, 但不执行 fsync; 2：写 wal, 而且执行 fsync。缺省是 1。</p><p>&quot;cachelast&quot;:允许在内存中保留每张表的最后一条记录。1 表示允许。</p><p>&quot;quorum&quot;:异步写入成功所需应答之法定数，1-3，可选项。缺省是 1。</p><p>&quot;fsync&quot;:当 wal 设置为 2 时，执行 fsync 的周期，单位是毫秒，最小为 0，表示每次写入，立即执行 fsync. 最大为 180000，可选项。缺省是 3000。</p><p>&quot;update&quot;: 支持数据更新，0：否；1：是。可选项。缺省是 0。 ​ },</p><p>&quot;super_tables&quot;: [{ ​ &quot;name&quot;: 超级表名称，必选项。</p><p>&quot;child_table_exists&quot;: 子表是否已经存在，“yes”：是；&quot;no&quot;：否。指定“是”后，不再建子表，后面相关子表的参数就无效了。可选项，缺省是“no”。database 设置 drop = yes 时，无论配置文件内容，此参数将自动置为 no。</p><p>&quot;childtable_count&quot;: 建立子表个数 。该值需要大于 0。当 child_table_exists 为“no”时，必选项，否则就是无效项。</p><p>&quot;childtable_prefix&quot;: 子表名称前缀。当 child_table_exists 为“no”时，必选项，否则就是无效项。确保数据库中表名没有重复。</p><p>&quot;auto_create_table&quot;: 子表的创建方式，“yes”：自动建表；&quot;no&quot;：提前建表。可选项，缺省是“no”。当 child_table_exists 为 “yes” 时此参数将自动置为 no 。</p><p>&quot;batch_create_tbl_num&quot;: 一个 sql 批量创建子表的数目。</p><p>&quot;data_source&quot;: 插入数据来源，&quot;rand&quot;：实例随机生成；“sample”：从样例文件中读取。可选项。缺省是“rand”。</p><p>&quot;insert_mode&quot;: 插入数据接口，&quot;taosc&quot;：调用 TDengine 的 c 接口；“rest”：使用 restful 接口；“stmt”：使用 stmt （参数绑定）接口 （目前仅在 develop 分支代码中）。可选项。缺省是“taosc”。</p><p>&quot;insert_rows&quot;: 插入记录数，0：一直插入，永不退出；&gt;0：每个子表插入记录数，完成后实例退出。可选项，缺省是 0。</p><p>&quot;childtable_offset&quot;: 插入数据时，子表起始值。只在 drop=no &amp;&amp; child_table_exists= yes，该字段生效。</p><p>&quot;childtable_limit&quot;: 插入数据时，子表从 offset 开始，偏移的表数目。使用者可以运行多个 taosBenchmark 实例（甚至可以在不同的机器上）通过使用不同的 childtable_offset 和 childtable_limit 配置值来实现同时写入相同数据库相同超级表下多个子表。只在 drop=no &amp;&amp; child_table_exists= yes，该字段生效。</p><p>&quot;interlace_rows&quot;: 跟上面的配置一致，不过该处的配置优先，每个 stable 可以有自己单独的配置。最大不超过 num_of_records_per_req。</p><p>&quot;insert_interval&quot;: 同上。</p><p>&quot;max_sql_len&quot;: 同上</p><p>&quot;disorder_ratio&quot;: 插入数据时的乱序百分比，可选项，缺省是 0。</p><p>&quot;disorder_range&quot;: 乱序百分比不为 0 时，乱序时间戳范围，单位：ms。可选项，缺省是 1000，即 1 秒或 1000 毫秒。</p><p>&quot;timestamp_step&quot;: 每个子表中记录时间戳的步长，单位：ms。可选项，缺省是 1，即 1 毫秒。</p><p>&quot;start_timestamp&quot;: 子表中记录时间戳的起始值，支持&quot;2020-10-01 00:00:00.000&quot;和“now”两种格式，可选项，缺省是“now”。</p><p>&quot;sample_format&quot;: 当插入数据源选择“sample”时，sample 文件的格式，&quot;csv&quot;：csv 格式，每列的值与子表的 columns 保持一致，但不包含第 1 列的时间戳。可选项，缺省是”csv”。目前仅仅支持 csv 格式的 sample 文件。</p><p>&quot;sample_file&quot;:sample 文件，包含路径和文件名。当插入数据源选择“sample”时，该项为必选项。</p><p>&quot;use_sample_ts&quot;:sample 文件是否包含第一列时间戳，可选项: &quot;yes&quot; 和 &quot;no&quot;, 默认 &quot;no&quot;。(注意：若为 yes，则 disorder_ratio 和 disorder_range 失效)</p><p>&quot;tags_file&quot;: 子表 tags 值文件，只能是 csv 文件格式，且必须与超级表的 tags 保持一致。当该项为非空时，表示子表的 tags 值从文件中获取；为空时，实例随机生成。可选项，缺省是空。</p><p>&quot;columns&quot;: [{ 超级表的 column 列表，最大支持 1024 列（指所有普通列+超级列总和）。默认的第一列为时间类型，程序自动添加，不需要手工添加。</p><p>&quot;type&quot;: 该列的数据类型 ，必选项。</p><p>&quot;len&quot;: 该列的长度，只有 type 是 BINARY 或 NCHAR 时有效，可选项，缺省值是 8。</p><p>&quot;count&quot;:该类型的连续列个数，可选项，缺省是 1。</p><p>}],</p><p>&quot;tags&quot;: [{ 超级表的 tags 列表，type 不能是 timestamp 类型， 最大支持 128 个。</p><p>&quot;type&quot;: 该列的数据类型 ，必选项。</p><p>&quot;len&quot;: 该列的长度，只有 type 是 BINARY 或 NCHAR 时有效，可选项，缺省值是 8。</p><p>&quot;count&quot;:该类型的连续列个数，可选项，缺省是 1。</p><p>}]</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="查询功能测试的-json-配置文件">查询功能测试的 JSON 配置文件<a class="hash-link" href="#查询功能测试的-json-配置文件" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;filetype&quot;: &quot;query&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;cfgdir&quot;: &quot;/etc/taos&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;host&quot;: &quot;127.0.0.1&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;port&quot;: 6030,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;user&quot;: &quot;root&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;password&quot;: &quot;taosdata&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;confirm_parameter_prompt&quot;: &quot;no&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;databases&quot;: &quot;db&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;query_times&quot;: 2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;query_mode&quot;: &quot;taosc&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;specified_table_query&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;query_interval&quot;: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;concurrent&quot;: 3,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;sqls&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;sql&quot;: &quot;select last_row(*) from stb0 &quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;result&quot;: &quot;./query_res0.txt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;sql&quot;: &quot;select count(*) from stb00_1&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;result&quot;: &quot;./query_res1.txt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;super_table_query&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;stblname&quot;: &quot;stb1&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;query_interval&quot;: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;threads&quot;: 3,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;sqls&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;sql&quot;: &quot;select last_row(ts) from xxxx&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;result&quot;: &quot;./query_res2.txt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="配置文件解释-1">配置文件解释<a class="hash-link" href="#配置文件解释-1" title="Direct link to heading">​</a></h4><p>&quot;filetype&quot;: 本 taosBenchmark 实例进行哪种功能测试。&quot;query&quot;表示数据查询功能。必选项。</p><p>&quot;cfgdir&quot;: 配置文件 taos.cfg 所在的路径。因为 taosBenchmark 通过包含 taos 的动态库，去链接 taosd 服务，所以需要做好配置文件。可选项，缺省是 &quot;/etc/taos&quot;路径。</p><p>&quot;host&quot;: taosd 服务的 FQDN。可选项，缺省是“localhost“。</p><p>&quot;port&quot;: taosd 服务的端口号。可选项，缺省是 6030。</p><p>&quot;user&quot;: 用户名。可选项，缺省是“root“。</p><p>&quot;password&quot;: 密码。可选项，缺省是“taosdata&quot;。</p><p>&quot;confirm_parameter_prompt&quot;: 执行过程中提示是否确认，为 no 时，执行过程无需手工输入 enter。可选项，缺省是 no。</p><p>&quot;databases&quot;: 数据库名称。必选项。</p><p>&quot;query_times&quot;: 每种查询类型的查询次数</p><p>&quot;query_mode&quot;: 查询数据接口，&quot;taosc&quot;：调用 TDengine 的 c 接口；“resetful”：使用 restfule 接口。可选项。缺省是“taosc”。</p><p>&quot;specified_table_query&quot;: { 指定表的查询</p><p>&quot;query_interval&quot;: 执行 sqls 的间隔，单位是秒。可选项，缺省是 0。</p><p>&quot;concurrent&quot;: 并发执行 sqls 的线程数，可选项，缺省是 1。每个线程都执行所有的 sqls。</p><p>&quot;sqls&quot;: 可以添加多个 sql 语句，最多支持 100 条。</p><p>&quot;sql&quot;: 查询语句。必选项。</p><p>&quot;result&quot;: 查询结果写入的文件名。可选项，缺省是空，表示查询结果不写入文件。</p><p>&quot;super_table_query&quot;: { 对超级表中所有子表的查询</p><p>&quot;stblname&quot;: 超级表名称。必选项。</p><p>&quot;query_interval&quot;: 执行 sqls 的间隔，单位是秒。可选项，缺省是 0。</p><p>&quot;threads&quot;: 并发执行 sqls 的线程数，可选项，缺省是 1。每个线程负责一部分子表，执行所有的 sqls。</p><p>&quot;sql&quot;: &quot;select count(<!-- -->*<!-- -->) from xxxx&quot;。查询超级表内所有子表的查询语句，其中表名必须写成 “xxxx”，实例会自动替换成子表名。</p><p>&quot;result&quot;: 查询结果写入的文件名。可选项，缺省是空，表示查询结果不写入文件。</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>每条 sql 语句后的保存结果的文件不能重名，且生成结果文件时，文件名会附加线程号。
查询结果显示：如果查询线程结束一次查询距开始执行时间超过 30 秒打印一次查询次数、用时和 QPS。所有查询结束时，汇总打印总的查询次数和 QPS。</p></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="订阅功能测试的-json-配置文件">订阅功能测试的 JSON 配置文件<a class="hash-link" href="#订阅功能测试的-json-配置文件" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;filetype&quot;:&quot;subscribe&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;cfgdir&quot;: &quot;/etc/taos&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;host&quot;: &quot;127.0.0.1&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;port&quot;: 6030,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;user&quot;: &quot;root&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;password&quot;: &quot;taosdata&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;databases&quot;: &quot;db&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;confirm_parameter_prompt&quot;: &quot;no&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;specified_table_query&quot;:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &quot;concurrent&quot;:1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &quot;mode&quot;:&quot;sync&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &quot;interval&quot;:0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &quot;restart&quot;:&quot;yes&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &quot;keepProgress&quot;:&quot;yes&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &quot;sqls&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;sql&quot;: &quot;select * from stb00_0 ;&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;result&quot;: &quot;./subscribe_res0.txt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;super_table_query&quot;:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &quot;stblname&quot;: &quot;stb0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &quot;threads&quot;:1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &quot;mode&quot;:&quot;sync&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &quot;interval&quot;:10000,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &quot;restart&quot;:&quot;yes&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &quot;keepProgress&quot;:&quot;yes&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &quot;sqls&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;sql&quot;: &quot;select * from xxxx where ts &gt; &#x27;2021-02-25 11:35:00.000&#x27; ;&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;result&quot;: &quot;./subscribe_res1.txt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="配置文件解释-2">配置文件解释<a class="hash-link" href="#配置文件解释-2" title="Direct link to heading">​</a></h4><p>&quot;filetype&quot;: 本 taosBenchmark 实例进行哪种功能测试。&quot;subscribe&quot;表示数据查询功能。必选项。</p><p>&quot;cfgdir&quot;: 配置文件 taos.cfg 所在的路径。因为 taosBenchmark 通过包含 taos 的动态库，去链接 taosd 服务，所以需要做好配置文件。可选项，缺省是 &quot;/etc/taos&quot;路径。</p><p>&quot;host&quot;: taosd 服务的 FQDN。可选项，缺省是“localhost“。</p><p>&quot;port&quot;: taosd 服务的端口号。可选项，缺省是 6030。</p><p>&quot;user&quot;: 用户名。可选项，缺省是“root“。</p><p>&quot;password&quot;: 密码。可选项，缺省是“taosdata&quot;。</p><p>&quot;databases&quot;: 数据库名称。必选项。<!-- -->*<!-- -->*</p><p>&quot;confirm_parameter_prompt&quot;: 执行过程中提示是否确认，为 no 时，执行过程无需手工输入 enter。可选项，缺省是 no。</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>这里的订阅查询 sql 目前只支持 select <!-- -->*<!-- --> ，其余不支持。</p></div></div><p>&quot;specified_table_query&quot;: 指定表的订阅。</p><p>&quot;concurrent&quot;: 并发执行 sqls 的线程数，可选项，缺省是 1。每个线程都执行所有的 sqls。</p><p>&quot;mode&quot;: 订阅模式。目前支持同步和异步订阅，缺省是 sync。</p><p>&quot;interval&quot;: 执行订阅的间隔，单位是秒。可选项，缺省是 0。</p><p>&quot;restart&quot;: 订阅重启。&quot;yes&quot;：如果订阅已经存在，重新开始，&quot;no&quot;: 继续之前的订阅。(请注意执行用户需要对 dataDir 目录有读写权限)</p><p>&quot;keepProgress&quot;: 保留订阅信息进度。yes 表示保留订阅信息，no 表示不保留。该值为 yes，restart 为 no 时，才能继续之前的订阅。</p><p>&quot;resubAfterConsume&quot;: 配合 keepProgress 使用，在订阅消费了相应次数后调用 unsubscribe 取消订阅并再次订阅。</p><p>&quot;sql&quot;: 查询语句。必选项。</p><p>&quot;result&quot;: 查询结果写入的文件名。可选项，缺省是空，表示查询结果不写入文件。</p><p>&quot;super_table_query&quot;: 对超级表中所有子表的订阅。</p><p>&quot;stblname&quot;: 超级表名称。必选项。</p><p>&quot;threads&quot;: 并发执行 sqls 的线程数，可选项，缺省是 1。每个线程都执行所有的 sqls。</p><p>&quot;mode&quot;: 订阅模式。</p><p>&quot;interval&quot;: 执行 sqls 的间隔，单位是秒。可选项，缺省是 0。</p><p>&quot;restart&quot;: 订阅重启。&quot;yes&quot;：如果订阅已经存在，重新开始，&quot;no&quot;: 继续之前的订阅。</p><p>&quot;keepProgress&quot;: 保留订阅信息进度。yes 表示保留订阅信息，no 表示不保留。该值为 yes，restart 为 no 时，才能继续之前的订阅。</p><p>&quot;resubAfterConsume&quot;: 配合 keepProgress 使用，在订阅消费了相应次数后调用 unsubscribe 取消订阅并再次订阅。</p><p>&quot;sql&quot;: &quot; select count(<!-- -->*<!-- -->) from xxxx &quot;。查询语句，其中表名必须写成 “xxxx”，实例会自动替换成子表名。</p><p>&quot;result&quot;: 查询结果写入的文件名。可选项，缺省是空，表示查询结果不写入文件。</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>每条 sql 语句后的保存结果的文件不能重名，且生成结果文件时，文件名会附加线程号。</p></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/dingbo8128/tddocs/edit/main/docs/getting-started/taosdemo.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/tddocs/docs/getting-started/docker"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">通过 Docker 快速体验</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/tddocs/docs/getting-started/install"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">安装和卸载</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#使用-taosbenchmark-进行写入测试" class="table-of-contents__link toc-highlight">使用 taosBenchmark 进行写入测试</a></li><li><a href="#使用-taosbenchmark-进行查询和订阅测试" class="table-of-contents__link toc-highlight">使用 taosBenchmark 进行查询和订阅测试</a><ul><li><a href="#一个典型查询-json-示例文件内容" class="table-of-contents__link toc-highlight">一个典型查询 JSON 示例文件内容</a></li><li><a href="#查询相关的特有参数含义" class="table-of-contents__link toc-highlight">查询相关的特有参数含义</a></li><li><a href="#典型订阅-json-示例文件内容" class="table-of-contents__link toc-highlight">典型订阅 JSON 示例文件内容</a></li><li><a href="#订阅功能相关的特有参数含义" class="table-of-contents__link toc-highlight">订阅功能相关的特有参数含义</a></li></ul></li><li><a href="#结语" class="table-of-contents__link toc-highlight">结语</a></li><li><a href="#附录" class="table-of-contents__link toc-highlight">附录</a><ul><li><a href="#完整-taosbenchmark-命令行参数介绍" class="table-of-contents__link toc-highlight">完整 taosBenchmark 命令行参数介绍</a></li><li><a href="#json-格式的配置文件中所有参数说明" class="table-of-contents__link toc-highlight">JSON 格式的配置文件中所有参数说明</a></li><li><a href="#查询功能测试的-json-配置文件" class="table-of-contents__link toc-highlight">查询功能测试的 JSON 配置文件</a></li><li><a href="#订阅功能测试的-json-配置文件" class="table-of-contents__link toc-highlight">订阅功能测试的 JSON 配置文件</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/tddocs/docs/intro">文档</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/tdengine" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/tddocs/blog">博客</a></li><li class="footer__item"><a href="https://github.com/taosdata/TDengine" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">@2022 dingbo8128.github.io 页面内容仅供预览不保证正确性</div></div></div></footer></div>
<script src="/tddocs/assets/js/runtime~main.3310c905.js"></script>
<script src="/tddocs/assets/js/main.34e22e9a.js"></script>
</body>
</html>